***************
*** 25,31 ****
  #include <stdio.h>
  #include <stdlib.h>
  #include <string.h>
  #include <endian.h>
  
  #include <espeak-ng/espeak_ng.h>
  #include <espeak-ng/speak_lib.h>
--- 25,35 ----
  #include <stdio.h>
  #include <stdlib.h>
  #include <string.h>
+ // for BYTE_ORDER, BIG_ENDIAN
+ #if HAVE_ENDIAN_H
  #include <endian.h>
+ #endif
+ 
  
  #include <espeak-ng/espeak_ng.h>
  #include <espeak-ng/speak_lib.h>
***************
*** 348,353 ****
  		free(spect->frames);
  	}
  	spect->frames = calloc(n, sizeof(SpectFrame *));
  
  	spect->numframes = 0;
  	spect->max_x = 3000;
--- 352,361 ----
  		free(spect->frames);
  	}
  	spect->frames = calloc(n, sizeof(SpectFrame *));
+ 	if (spect->frames==NULL){
+ 		fprintf(stderr, "SpectFrame: Out of memory.\n");
+ 		return ENOMEM;
+ 	}
  
  	spect->numframes = 0;
  	spect->max_x = 3000;
